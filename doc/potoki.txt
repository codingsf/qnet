жопка: первый seed читается обратно норм, а второй по-прежнему возвертает фигню :(

что читаетсч из 0х58?
51B10F2

ага?

тчо есть nrst?

reset компа

эм... А почему первый сид нормально пишет/читает, а второ нет?

второй почему-то не пишется - надо смотреть софт

ща....

второй я делал copy-past'ом, мог и накосячить...

лол

Боб нормалды - ща Алиску проверю

Тоже норма.
Проверяем что у нас будет в rawDMA?

угу

это нормально, что при нулевом сиде генерянтся одни нули?

мне это не понятно... но наверное возможно

ща ещё пару раз проверю

че-т фигня какая-то творится. Либо я криво читаю с платы, либо фигня гонится. Ща проверюсь на табличках.

Так. Ещё раз с режимами - 4 основной, 6 - таблицы по кругу?

это касается только таблицы ЦАП


Тогда фигня... Я ща записал и в Алису, и в Боба одни нули в rnd, детектор выключен (т.е. должны быть всё время нули), а чиатется вообще черте что

о, вроде норм пошло...

ну, сдвигов таблиц Алисы относительно Боба нет.
Ща ещё раз возвращаемся к ПСП...

как-то странно таблички разъехались....

о, а после записи режима таблицы всё вернулось вроде как...

ща ещё номера меток гляну

ну, на первых пакетах всё ок, дальше уходит

на первом?
ну, 0xC20 якобы его номер

0хс21 уже кривой?

с21 не посмотреть - у меня запись по одному пакету пока :(

увидел
интересно, а почему вдруг начинают считываться разные пакеты?

здесь надо правильно понимать механизм работы плат: если читать не подряд а иногда то результат непредсказуем, ибо первый раз мы читаем первый пакет... делаем паузу и читаем еще - будет читаться пакет из ячейки памяти 2, но если пауза была слишком большой то память уже перепишется каким-нибудь пакетом 1123545

ну, я пытаюсь прочесть на Алисе и Бобе пакеты одновременно, поэтому была надежда, что они будут с одной и той же меткой :(

у нас вроде память 16М16, то есть 256 Мбит и две штуки 512 Мбит, т е 64Мбайта 
если размер пакета 1 мегабайт, в память помещается 64 штуки, а значит если старшие биты метки различаются то это пакеты из разных"кругов" памяти - нереально считать одновременно на разных машинах

Тогда в таком случае надо считывать на обоих машинах потоком, искать одинаковые метки и их уже сравнивать?

кстати да, тема которую придумал Алексей может не прокатить: он предлагал ввести метки чтобы накачав из плат данных потом найти одинаковые метки и эти пакеты сравнивать, но выходит можно накачть много а в них пакеты слишком разные  одинаковых не попадется


почему одинаковых не попадётся-то?

может не попасться - не повезет ;(

эм... Если у нас всё в платах скидывается по старту, то почему если после старта начать записывать поток, в нём не будет совпадений?

если писать все подряд, то все будет норм, может кстати Алексей так и делает - читает в фоне все подряд и когда занят вычислением, просто сливает не нужные пакеты, а когда освобождается начинает искать одинаовые

ага, щаз. Для этого надо вводить многопоточность, а в текущей версии он этого делать не хочет. Поэтому я и вожусь с .Net'овским софтом.... И да, у него бывают моменты, когда номера меток вообще не совпадают - приходится перезапускать софтины...

Ещё один вопрос. Сейчас у нас как DMA организован? Мы записываем dmaPages, в ответ через какое-то время получаем прерывание DMA. Считываем куда-нить к себе raw-data, потом опять записываем dmaPages, разрешая следующее прерывание. 
Сейчас у меня софт делает ровно один цикл writeDMApages - copy raw-data. Но почему-то от цикла к циклу метки разбегаются. Это из-за того что таблицы в плате продолжают сами по себе крутиться, а writeDMApages регулирует исключительно передачу по dma?

по порядку - таблицы в платах вертятся без остановки и также без остановки пишутся по кругу в память (на борту)
читаются данные из памяти (на борту) исключительно по writeDMApages, то есть нет запросов со стороны софта - нет чтения из памяти. Адрес чтения инкрементируется по writeDMApages, а это значит, что сделав паузу, мы уже не знаем в какой пакет попадем

Меня что удивляет в чтении пакетов - когда мы только начинаем (т.е. посылаем старт) и первый раз записываем ДМА страницы в плату, мы считываем одинаковые пакета. А вот потом (через какой-то промежуток времени), когда точно так же синхронно по сети второй раз записываем ДМА страницы в платы, уже получаем разные пакеты. По логике, если задержка по сети даёт такой лаг, то он должен сказываться уже на первых пакетах после старта. И да, старт я подаю каждый раз - пакеты перестают опять разбегаться именно после setTableMod

сейчас ещё раз для гарантии проверю

поняяятно, один фиг разбегаются. Про setTableMod, видимо, было просто совпадение. Кстати, а с какого номера начинаются номера пакетов? с нуля? А почему тогда мы постоянно получаем первые пакеты (после старта) около 20 03? Это как раз таки наши лаги?

можно в железо заглянуть

надо старт

просто старт, или старт + чтение ДМА?

лучше второй вариант

ну, старт прошел, а вот чтение по сети сдохло :(

вот первое записанное слово

то есть первая метка 0000

о_О мы пропускаем аж 8480 пакетов между стартом и чтением?!!

1 пакет = 1 МБ = 2048 пар рнд, то есть 20 000 нс = 20 мкс
20 * 8500 = 170мс
не так уж и много

всё равно хочу Real Time Operating System :(

скорость от этого не повысится - будет просто одинаково все время

ну да, логично. Думаю, тогда на сегодня можно залить эти прошивки железно в платы, а я дальше буду развлекаться с потоковой записью и обработкой...

сейчас в алиске?
yep

в бобиков поочереди

первый готов

след

готов

5 сек - перепишу файлы и надо питание перевключать

готово! Удачи!!!

спасибо!

  